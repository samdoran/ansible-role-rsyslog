---
# The facility determines the file name as well as format of the file on the
# syslog collector. This in turn affects how the logs are ingested, parsed,
# and tagged my logstash.
#
# local0 and local1 write out the raw data as shipped by rsyslog.
# local2 will use rsyslog to wrap the messages in logstash friendly json.
# local0 --> [tag]-YYYYMMDD.raw.log
# local1 --> [tag]-YYYYMMDD.raw.json.log
# local2 --> [tag]-YYYYMMDD.json.log
#
# imfile_groups.group needs to match an ansible group name

imfile_groups:
  - group: redis
    logpath: /var/log/redis/redis.log
    tag: redis
    facility: local0
    severity: info

  - group: ls_parser
    logpath: /var/log/logstash/logstash.log
    tag: logstash
    facility: local0
    severity: info

  - group: nginx
    logpath: /var/log/nginx/acces.log
    tag: nginx-acces
    facility: local0
    severity: info

  - group: nginx
    logpath: /var/log/nginx/error.log
    tag: nginx-error
    facility: local0
    severity: info

  - group: backuppc
    logpath: /var/log/BackupPC/LOG
    tag: BackupPC
    facility: local0
    severity: info

  - group: nessus
    logpath: /opt/nessus/var/nessus/logs/nessusd.messages
    tag: nessus
    facility: local0
    severity: info
